---
title: 卡特兰数(Catalan Number)
date: 2019-09-23 19:18:40
tags:
    - Math
categories:
	- Math
---

卡特兰数又称卡塔兰数，英文名Catalan number，是组合数学中一个常出现在各种计数问题中出现的数列。该数在计算机专业中比较重要，有一些具体的应用实例。这篇文章主要分三部分：

1. 卡特兰数递归式的含义解释
2. 卡特兰数表达式的证明过程
3. 卡特兰数的计算机中的应用

<h2>Catalan Number递归式解释</h2>

假设h(0)=1，h(1)=1，catalan数满足递推式：
$$
h(n) = h(0)*h(n-1) + h(1)*h(n-2) + h(2)*h(n-3) + ... +h(n-1)*h(0) \tag{1.1}
$$
递归式背后有什么物理含义呢，这里以出栈序列问题进行说明：

<font color='red'>问题描述：</font>一个栈(无穷大)的进栈序列为1，2，3，…，n，有多少个不同的出栈序列?<br>

<font color='green'>含义解释：</font>首先，我们设$h(n)$=序列个数为n的出栈序列种数。（我们假定，最后出栈的元素为k，显然，k取不同值时的情况是相互独立的，也就是求出每种k最后出栈的情况数后可用加法原则，由于k最后出栈，因此，在k入栈之前，比k小的值均出栈，此处情况有$h(k-1)$种，而之后比k大的值入栈，且都在k之前出栈，因此有$h(n-k)$种方式，由于比k小和比k大的值入栈出栈情况是相互独立的，此处可用乘法原则，$h(n-k)*h(k-1)$种，求和便是Catalan递归式。



<h2>Catalan Number表达式证明</h2>

第n个卡特兰数h(n)表达式如下
$$
h(n)=\frac{C_{2n}^{n}}{n+1}=C_{2n}^{n}-C_{2n}^{n-1} \tag{1.2}
$$
具体证明过程如下

<div align="center">
    <img src="/images/catalan1.jpeg">
</div>

<div align="center">
    <img src="/images/catalan2.jpeg">
</div>

<div align="center">
    <img src="/images/catalan3.jpeg">
</div>

为了便于编程实现，需要进一步推导$h(n)$与$h(n-1)$之间的关系

已知$h(n)$，易知
$$
h(n-1)=\frac{C_{2n-2}^{n-1}}{n}
$$
推导$h(n)$的$C_{2n}^{n}$和$h(n-1)$的$C_{2n-2}^{n-1}$之间的关系，由$kC_{n}^{k}=nC_{n-1}^{k-1}$知
$$
\begin{align}
n*C_{2n}^{n}&=2nC_{2n-1}^{n-1} \\
C_{2n}^{n}&=2C_{2n-1}^{n-1} \\
C_{2n}^{n}&=2\frac{(2n-1)C_{2n-2}^{n-1}}{n} \\
C_{2n}^{n}&=2(2n-1)h(n-1) \\
\frac{C_{2n}^{n}}{n+1}&=\frac{2(2n-1)}{n+1}h(n-1) \\
h(n)&=\frac{2(2n-1)}{n+1}h(n-1)
\end{align}
$$
最终得到$h(n)$和$h(n-1)$之间的递归式$h(n)=\frac{2(2n-1)}{n+1}h(n-1)$



<h2>Catalan Number应用实例</h2>

<h3>括号匹配问题</h3>

<font color='red'>问题描述: </font>矩阵连乘 $P=A_1A_2...A_n$，依据乘法结合律，不改变其顺序，只用括号表示成对的乘积，问有几种括号化的方案？<br>

问题转换一下就是n对括号的正确匹配方案，可以做一下<a href="https://leetcode.com/problems/generate-parentheses/">LeetCode-22</a>

<h3>出栈次序问题</h3>

<font color='red'>问题描述: </font>一个栈(无穷大)的进栈序列为1,2,3,..n,有多少个不同的出栈序列?<br>

出栈问题问题正是卡特兰数递归式$h(n)=h(0)h(n-1)+h(1)h(n-2)+...+h(n-1)h(0)$的由来

<h3>相关应用问题</h3>

1. 有2n个人排成一行进入剧场，入场费5元。其中只有n个人有一张5元钞票，另外n人只有10元钞票，剧院无其它钞票，问有多少中方法使得只要有10元的人买票，售票处就有5元的钞票找零？(将持5元者到达视作将5元入栈，持10元者到达视作使栈中某5元出栈)<br>

2. n个1和n个0组成一个2n位的二进制数，要求从左到右扫描，0的累计数不小于1的累计数，求满足条件的的数。<br>

3. 12个人排成两排，每排必须是从矮到高排列，而且第二排比对应的第一排的人高，问排列方式有多少种？<br>

   我们先把这12个人从低到高排列，然后，选择6个人排在第一排，那么剩下的6个肯定是在第二排。对问题进行转化：用0表示对应的人在第一排，用1表示对应的人在第二排，那么含有6个0，6个1的序列，并且任意前缀中0的个数大于等于1的个数就对应一种方案，转化后的问题就是问题2了。<br>

4. 给定节点组成二叉树的问题：给定n个节点，能构成多少种形状不同的二叉树？<br>

   先取一个点作为顶点，然后左边依次可以取0至n-1个相对应的，右边是n-1到0个，两两配对相乘，就是$h(0)*h(n-1) + h(2)*h(n-2) + ... + h(n-1)h(0)=h(n)$能构成$h(n)$个，因此二叉树问题也可以解释卡特兰数递归式(1.1)式的由来<br>

5. n*n棋盘从左下角走到右上角而不穿过主对角线的走法？<br>

   要从左下角走到右上角则必须向上走n步，向右n步，同时为了不跨过主对角线，则走过的步数中向上走的步数必须大于等于向右走的步数，剖析之后发现这个问题与问题3是等价问题，走法有卡特兰数$h(n)$种。可以做一下下面两题练练手：<br>

   <a href="http://acm.hdu.edu.cn/showproblem.php?pid=2067">hdoj2067-小兔的棋盘</a><br>

   <a href="https://leetcode.com/problems/unique-paths/">LeetCode62-Unique Paths</a><br>

6. n个+1和n个-1构成的2n项序列，其部分和总满足：$a_1+a_2+...+a_n>=0$的序列的个数。<br>

   卡特兰数表达式(1.2)式就是以该问题模型为基础推导出来的<br><br>



<font color="green" size=4>参考链接:</font>

1. https://blog.csdn.net/ACdreamers/article/details/7628667



